private: System::Void Open_Click(System::Object^ sender, System::EventArgs^ e) {
    try {
        if (OFD->ShowDialog() == System::Windows::Forms::DialogResult::OK) {
            Picture->ImageLocation = OFD->FileName;
            path = System::IO::Path::GetDirectoryName(OFD->FileName);
            files = System::IO::Directory::GetFiles(path);
            for (int i = 0; i < files->Length; i++) {
                if (files[i] == OFD->FileName) {
                    currentIndex = i;
                    break;
                }
            }
        }
    } catch (Exception^ ex) {
        MessageBox::Show("An error occurred while opening the file: " + ex->Message, "Error", MessageBoxButtons::OK, MessageBoxIcon::Error);
    }
}
